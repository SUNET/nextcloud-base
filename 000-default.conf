# This file is from the docker image
LoadModule remoteip_module /usr/lib/apache2/modules/mod_remoteip.so
<VirtualHost *:80>
        ServerAdmin webmaster@localhost
        DocumentRoot /var/www/html

        ErrorLog ${APACHE_LOG_DIR}/error.log
        CustomLog ${APACHE_LOG_DIR}/access.log combined
        <Directory /var/www/html/>
                Require all granted
                AllowOverride All
                Options FollowSymLinks

                <IfModule mod_allowmethods.c>
                  <Directory /var/www/html>
                    AllowMethods reset
                  </Directory>
                </IfModule>
                <IfModule mod_dav.c>
                    Dav off
                </IfModule>
                <IfModule mod_rewrite.c>
                    RewriteEngine On
                    RewriteRule ^.well-known/ocm$ /ocm-provider [NC]
                </IfModule>
        </Directory>
        <Directory /var/www/html/data>
                Require all denied
        </Directory>
</VirtualHost>


<VirtualHost *:443>
        ServerAdmin webmaster@localhost
        DocumentRoot /var/www/html
        # Log format config
        LogFormat "%{X-Forwarded-For}i %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\"" common
        SetEnvIf X-Forwarded-For "^.*\..*\..*\..*" forwarded

        # Header config
        RemoteIPHeader X-Forwarded-For
        ErrorDocument 404 /404.html
        ErrorLog ${APACHE_LOG_DIR}/error.log
        CustomLog ${APACHE_LOG_DIR}/access.log combined env=forwarded
        SSLEngine On
        SSLCertificateFile /etc/ssl/certs/ssl-cert-snakeoil.pem
        SSLCertificateKeyFile /etc/ssl/private/ssl-cert-snakeoil.key
        <Directory /var/www/html/>
                LimitRequestBody 0
                Require all granted
                AllowOverride All
                Options FollowSymLinks
                <IfModule mod_allowmethods.c>
                  <Directory /var/www/html>
                    AllowMethods reset
                  </Directory>
                </IfModule>
                <IfModule mod_dav.c>
                    Dav off
                </IfModule>
                <IfModule mod_rewrite.c>
                    RewriteEngine On
                    RewriteRule ^.well-known/ocm$ /ocm-provider [NC]
                </IfModule>
        </Directory>
        <Directory /var/www/html/data>
                Require all denied
        </Directory>
</VirtualHost>
# vim: syntax=apache ts=4 sw=4 sts=4 sr noet
